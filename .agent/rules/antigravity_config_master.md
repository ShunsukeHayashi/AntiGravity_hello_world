---
description: Windsurf/Antigravity エージェント設定（ルールとワークフロー）を生成するためのマスターガイド
glob: "**/*"
trigger: never
---
# Antigravity 設定マスターガイド

このルールは、新しい `.agent` 設定ファイル（ルールやワークフロー）を作成する際の「正解」となる基準です。新しい設定を作るよう依頼された場合は、必ずこのファイルを参照してください。

## 1. ファイル構造と配置

*   **プロジェクトルート**: `<project_root>/.agent/`
*   **ルール (Rules)**: `.agent/rules/<わかりやすい名前>.md` に保存
*   **ワークフロー (Workflows)**: `.agent/workflows/<わかりやすい名前>.md` に保存
*   **コンテキスト指示 (Instructions)**: `AGENTS.md` として保存 (グローバルはルート、スコープ付きはサブディレクトリ)。

## 2. ルール (.agent/rules/*.md)

ルールはエージェントの「振る舞い」や「スタイル」を規定します。

### フォーマット
```markdown
---
description: <このルールが何を強制するかについての短い説明>
glob: "<file_pattern>"  # 例: "**/*.ts" や "**/*"
trigger: <always_on | on_file_open | ...> # 重要なルールは通常 'always_on'
---
# <ルールのタイトル>

<Markdown形式のルール内容>
- 明確な指示を使用してください。
- @filename を使用して特定のファイルを参照できます。
```

### ベストプラクティス
- **スコープ**: 可能であれば `glob` を使用して特定の言語やディレクトリをターゲットにしてください。
- **トーン**: 直接的かつ指示的に記述してください。
- **言語**: 日本語を使用してください。

## 3. ワークフロー (.agent/workflows/*.md)

ワークフローは「繰り返し行う一連の手順」を定義します。

### フォーマット
```markdown
---
description: <アクション指向の短い説明>
---
1. 手順1
2. 手順2
// turbo
3. 手順3 (自動実行)
```

### 機能
- **Turbo Mode**:
    - `// turbo`: *次の* コマンドステップを自動実行します。
    - `// turbo-all`: *すべての* コマンドステップを自動実行します（慎重に使用）。
- **呼び出し**: ユーザーが `/workflow-name` と入力してトリガーします。

## 4. 生成プロトコル

"Xのためのルール/ワークフローを作成して" と依頼された場合:

1.  **分析**: それは受動的なガイドライン（ルール）か、能動的なプロセス（ワークフロー）か？
2.  **ドラフト**: 有効な Frontmatter (YAML) を含む内容を作成する。
3.  **パス**: ワークスペースルートに基づいて絶対パスを決定する。
4.  **実行**: `write_to_file` を使用して作成する。
5.  **検証**: ファイルが存在することを確認する。

## 5. 主要な制約
- **最大長**: 1ファイルあたり12,000文字。
- **フォーマット**: 厳格なMarkdown。
- **安全性**: 明示的に "turbo" が承認されていない限り、ワークフロー内で破壊的なコマンドを `SafeToAutoRun: false` なしで自動実行しないでください。
